@import '~@wordpress/base-styles/breakpoints';

// Media and text block is modified so that the content overlaps the image
// horizontally, and the image over-extends the content vertically. The
// background color is also only applied to the content part rather than the
// entire block.
//
// These changes only apply when "stylized" style is active.
.wp-block-media-text.is-style-stylized {
  // Amount in pixels that the image vertically stretches further than the
  // content.
  $image-overextend-amount: 58;

  // Amount in pixels that the content overlaps on top of the image horizontally.
  $content-overlap-amount-desktop: 120;
  $content-overlap-amount-mobile: 32;

  // Remove the default background color and sets the color on the content part
  // instead. This has to be duplicated here from the globals since the
  // background color has to apply to the inner content element instead of where
  // the class is located.
  @if $is-frontend {
    background-color: transparent !important;
  }
  @if not $is-frontend {
    @at-root .wp-block[data-type="core/media-text"] {
      background-color: transparent !important;
    }
  }
  @each $color-name, $color-value in $color-palette {
    @if $is-frontend {
      &.has-#{$color-name}-background-color .wp-block-media-text__content {
        background-color: $color-value;
      }
    }
    @if not $is-frontend {
      @at-root .wp-block[data-type="core/media-text"].has-#{$color-name}-background-color .block-editor-inner-blocks {
        background-color: $color-value;
      }
    }
  }

  // Desktop styles.
  @media (min-width: #{$break-small + 1}) {
    // Add some vertical padding to the block so that it doesn't overlap other
    // elements on the page, even with the image over-extending the block.
    padding-top: #{$image-overextend-amount * 1px};
    padding-bottom: #{$image-overextend-amount * 1px};

    // Makes the content part wider than usually and sets the position so that it
    // overlaps the image.
    @if $is-frontend {
      & .wp-block-media-text__content {
        position: relative;
        left: -$content-overlap-amount-desktop * 1px;
        right: 0;
        width: calc(100% + #{$content-overlap-amount-desktop * 1px});
        padding: 82px 50px;
      }

      &.has-media-on-the-right .wp-block-media-text__content {
        left: 0;
        right: -$content-overlap-amount-desktop * 1px;
      }
    }
    @if not $is-frontend {
      & > .block-editor-inner-blocks {
        position: relative;
        left: -$content-overlap-amount-desktop * 1px;
        right: 0;
        width: calc(100% + #{$content-overlap-amount-desktop * 1px});
        padding: 82px 50px;
      }

      &.has-media-on-the-right > .block-editor-inner-blocks {
        left: 0;
        right: -$content-overlap-amount-desktop * 1px;
      }
    }

    // Makes the image part taller than usually so that it extends past the
    // content part. The editor drag handle is also updated to match.
    @if $is-frontend {
      & > figure {
        // The figure container is made higher than the text content and relative so
        // that the image may set its height as 100% of the figure.
        position: relative;
        height: calc(100% + #{2 * $image-overextend-amount * 1px}) !important;
      }
    }
    @if not $is-frontend {
      & figure {
        // The figure container is made higher than the text content and relative so
        // that the image may set its height as 100% of the figure.
        position: relative;
        height: calc(100% + #{2 * $image-overextend-amount * 1px}) !important;
      }

      & > .editor-media-container__resizer {
        height: 100% !important;
        top: -$image-overextend-amount * 1px;
      }

      & > .editor-media-container__resizer .components-resizable-box__handle {
        height: calc(100% + #{2 * $image-overextend-amount * 1px});
      }
    }
  }

  // Mobile styles.
  @media (max-width: $break-small) {
    // Sets padding around content and moves it so it overlaps the image.
    @if $is-frontend {
      & .wp-block-media-text__content {
        position: relative;
        top: -$content-overlap-amount-mobile * 1px;
        bottom: 0;
        margin-left: 15px;
        margin-right: 15px;
        margin-bottom: -32px;
        padding: 32px 17px;
      }
    }
    @if not $is-frontend {
      & > .block-editor-inner-blocks {
        position: relative;
        top: -$content-overlap-amount-mobile * 1px;
        bottom: 0;
        margin-left: 15px;
        margin-right: 15px;
        margin-bottom: -32px;
        padding: 32px 17px;
      }
    }

    // Moves the content part to be always below the image on mobile regardless
    // of direction.
    @if $is-frontend {
      &.has-media-on-the-right {
        .wp-block-media-text__media {
          grid-row: 1;
        }
        .wp-block-media-text__content {
          grid-row: 2;
        }
      }
    }
    @if not $is-frontend {
      &.has-media-on-the-right {
        .editor-media-container__resizer {
          grid-row: 1;
        }
        & > .block-editor-inner-blocks {
          grid-row: 2;
        }
      }
    }
  }


}
